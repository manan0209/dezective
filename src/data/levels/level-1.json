{
  "id": "level-1",
  "title": "The Missing Email",
  "difficulty": "Beginner",
  "description": "A critical email has gone missing from the company server. Your job is to track down what happened and recover the information.",
  "scenario": {
    "briefing": "Emergency briefing: The CEO's confidential email about the upcoming merger has disappeared from our mail server. The IT team noticed suspicious activity around 3:47 AM. You have access to the compromised server logs and need to determine what happened.",
    "objective": "Find the missing email and identify how it was accessed.",
    "timeLimit": 1800,
    "maxHints": 3
  },
  "environment": {
    "serverName": "mail-server-01",
    "osType": "Linux",
    "availableCommands": [
      "ls", "cat", "grep", "find", "head", "tail", "less", "pwd", "cd", "history", "whoami", "ps", "netstat", "last"
    ],
    "fileSystem": {
      "/var/log/mail.log": {
        "type": "file",
        "content": [
          "2024-01-15 03:45:12 mail-server-01 postfix/smtp[1234]: connect from unknown[192.168.1.100]",
          "2024-01-15 03:47:23 mail-server-01 postfix/smtp[1234]: warning: SASL authentication failure",
          "2024-01-15 03:47:45 mail-server-01 postfix/smtp[1234]: client=unknown[192.168.1.100], sasl_method=PLAIN, sasl_username=ceo@company.com",
          "2024-01-15 03:48:01 mail-server-01 postfix/smtp[1234]: message-id=<merger_details_2024@company.com> from=ceo@company.com",
          "2024-01-15 03:48:15 mail-server-01 postfix/smtp[1234]: to=external_contact@rival-corp.com, status=sent"
        ]
      },
      "/var/log/auth.log": {
        "type": "file",
        "content": [
          "2024-01-15 03:40:15 mail-server-01 sshd[2345]: Failed password for invalid user admin from 192.168.1.100",
          "2024-01-15 03:42:22 mail-server-01 sshd[2345]: Accepted password for ceo from 192.168.1.100",
          "2024-01-15 03:47:10 mail-server-01 su: pam_unix(su:session): session opened for user mail by ceo(uid=1001)"
        ]
      },
      "/home/ceo/.bash_history": {
        "type": "file",
        "content": [
          "ssh mail-server-01",
          "sudo su - mail",
          "cd /var/spool/mail",
          "grep -r 'merger' .",
          "cat ceo",
          "cp important_email.eml /tmp/backup.eml",
          "rm important_email.eml",
          "exit"
        ]
      },
      "/tmp/backup.eml": {
        "type": "file",
        "content": [
          "From: ceo@company.com",
          "To: board@company.com",
          "Subject: CONFIDENTIAL - Merger Discussion",
          "Date: 2024-01-14 18:30:00",
          "",
          "Team,",
          "",
          "The acquisition talks with TechCorp are progressing well.",
          "Expected completion: Q2 2024",
          "Valuation: $500M",
          "",
          "Keep this strictly confidential until announcement.",
          "",
          "Best,",
          "CEO"
        ]
      }
    }
  },
  "clues": [
    {
      "id": "clue-1",
      "title": "Suspicious Login",
      "description": "Someone accessed the CEO's account at an unusual time.",
      "hint": "Check the authentication logs for login activity around 3:47 AM",
      "triggerCommands": ["cat /var/log/auth.log", "grep '03:4' /var/log/auth.log"],
      "revealed": false
    },
    {
      "id": "clue-2", 
      "title": "Email Activity",
      "description": "The mail server shows activity involving the CEO's email account.",
      "hint": "Look at the mail server logs to see what emails were processed",
      "triggerCommands": ["cat /var/log/mail.log", "grep 'ceo@company.com' /var/log/mail.log"],
      "revealed": false
    },
    {
      "id": "clue-3",
      "title": "Command History",
      "description": "The CEO's bash history shows what commands were executed.",
      "hint": "Check the CEO's command history to see what they did on the server",
      "triggerCommands": ["cat /home/ceo/.bash_history"],
      "revealed": false
    }
  ],
  "solution": {
    "steps": [
      "Examine authentication logs to see the CEO logged in at 3:42 AM",
      "Check mail logs to see an email was sent to external_contact@rival-corp.com", 
      "Look at bash history to see the CEO copied and deleted an important email",
      "Find the backup email in /tmp/backup.eml with merger details"
    ],
    "finalAnswer": "/tmp/backup.eml",
    "explanation": "The CEO's account was compromised and used to forward confidential merger information to a rival company. The attacker tried to cover their tracks by deleting the original email, but left a backup copy in /tmp/."
  },
  "scoring": {
    "maxScore": 1000,
    "timeBonus": 300,
    "hintPenalty": 100,
    "wrongCommandPenalty": 50
  }
}
